
// Test Loads
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Companies.csv' AS line WITH line
LIMIT 1
RETURN line
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Engines.csv' AS line WITH line
LIMIT 1
RETURN line
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Airplanes.csv' AS line WITH line
LIMIT 1
RETURN line
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Theaters.csv' AS line WITH line
LIMIT 1
RETURN line

CREATE CONSTRAINT ON (a:Airplane) ASSERT a.Airplane IS UNIQUE;
CREATE CONSTRAINT ON (e:Engine) ASSERT e.Engine IS UNIQUE;
CREATE CONSTRAINT ON (c:Company) ASSERT c.Name IS UNIQUE;

USING PERIODIC COMMIT
// Create Company
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Companies.csv' AS row
MERGE (Company:

// Create Airplanes
LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Airplanes.csvv' AS row
MERGE (airplane:Airplane {name: row.Airplane, model: row.Model})
    ON CREATE SET airplane.name = row.Airplane;

LOAD CSV WITH HEADERS FROM 'https://raw.githubusercontent.com/billjclark/Airplane360/master/Airplanes.csv' AS line WITH line return line